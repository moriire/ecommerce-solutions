import{C as f,u as k,I as P,g as d,K as v,G as u,D as I}from"./index-BKNTjOOu.js";const D=f("productcrud",()=>{const s=k(),i=P(),o=d([]),p=v({package:"",description:"",name:"",category:"",price:500,quantity:1,profile:parseInt(s.userInfo.pk),brand:"",discount:5,condition:""}),m=d([]),r=d([]),l=async()=>{try{const t=await u.get(`product-with-images?product__profile__user__id=${s.userInfo.pk}&limit=8`);o.value=t.data.results,console.log(t.data)}catch(t){console.log(t)}},h=async()=>{try{const t=await u.post("product",p);t.status===201&&(console.log(t),await g(t.data.id)),console.log(t.data),l()}catch(t){console.log(t)}},w=t=>{const e=t.target.files;for(let a=0;a<e.length;a++){const c=new FileReader;c.onload=n=>{r.value.push({file:e[a],preview:n.target.result,progress:0})},c.readAsDataURL(e[a])}},y=async t=>{const e=await u.delete(`product/${t}`);console.log(e),e.data.status===204&&await l()},g=async t=>{for(let e=0;e<r.value.length;e++){const a=new FormData;a.append("product",t),a.append("img",r.value[e].file);try{const c=await u.post("thumbs",a,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:n=>{r.value[e].progress=Math.round(n.loaded/n.total*100)}});setTimeout(()=>i.push(`/product/upload/${t}`),2e3)}catch(c){console.error("Error uploading image:",c)}}};return{productData:p,addProduct:h,registeredProducts:o,getUserProducts:l,uploadImages:g,images:r,productImages:m,showFileUpload:w,deleteProduct:y}}),S=f("package",()=>{const s=d([]);return{packages:s,getPackages:async()=>{try{const o=await I.get("packages");s.value=o.data,console.log(o.data)}catch(o){console.log(o)}}}});export{D as a,S as u};
